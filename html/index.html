<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Playgrub</title>
<link rel="stylesheet" type="text/css" href="css/main.css" />
<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js' type='text/javascript'></script>
<script src='/js/xml2json.js' type='text/javascript'></script>
<script src='/js/playgrub.js' type='text/javascript'></script>
<script src='/js/playdar_compressed.js' type='text/javascript'></script>
<script src='js/soundmanager2.js' type='text/javascript'></script>
<script type='text/javascript'>
// Setup Playgrub
Playgrub.Events = {

    // Playgrub init
    init: function() {

        var xspf_url = Playgrub.Util.xspf_hash();
        var axspf = '';

        // if there's no xspf specified, grab the most recent playlist
        if(xspf_url == '')
            xspf_url = Playgrub.PGHOST+'{{ headers.0.playlist }}.xspf';

        if(document.location.hash == '')
            document.location.hash = 'xspf='+xspf_url;

        new Playgrub.Playlist();
        new Playgrub.Sidebar();
        new Playgrub.XSPFSource(xspf_url);  // TODO: extends PlaylistSource
        new Playgrub.Player();
        Playgrub.player.setup_playdar();

        // this is generated by the Django template with the latest playlists
        {% for header in headers %}
        axspf = Playgrub.PGHOST+'{{ header.playlist }}.xspf';
        Playgrub.container.playlists.push(axspf)
        {% endfor %}
    },

    // source done finding songs
    foundSongs: function() {
        new Playgrub.Content();
        // tell container it can show the playlist
        Playgrub.container.playlist_loaded();
        Playgrub.content.display_playlist();
        Playgrub.player.resolve_current_playlist();
    },
};

// setup soundManager2
soundManager.waitForWindowLoad = true;
soundManager.url = '/static/soundmanager2_flash9.swf';
soundManager.flashVersion = 9;
soundManager.useMovieStar = true;
soundManager.consoleOnly = true;
soundManager.debugMode = false;
soundManager.flashLoadTimeout = 0;

// jquery is ready
$(function() {
    Playgrub.Events.init();
});
</script>
</head>
<body>
<div id='page-frame'>

<div id='playlists'>
</div>

<div id='playgrub-main'>
    <div id='playgrub-logo'><a href='http://www.playgrub.com'><img src='images/Playgrub_logo.png' /></a></div>
    <div class='playgrub-about'>
        Playgrub is an easy way to play web pages with <span id='playdar-link'><a href='http://www.playdar.org/download'>Playdar</a></span>.
    </div>
    <div id='playgrub-bookmarklet-setup' class='playgrub-about'>
        To install Playgrub drag this icon to your browser's bookmarks bar:
        <p />
        <div id='playgrub-icon'>
            <a href="javascript:(function(){ host='http://www.playgrub.com/js/'; _my_script=document.createElement('SCRIPT'); _my_script.type='text/javascript'; _my_script.src=host+'playgrub_bookmarklet.js?'; document.getElementsByTagName('head')[0].appendChild(_my_script); })();" id="bookmarklet">
            <img src='images/Playgrub_icon.png' alt='Grub' title='Grub' />
            </a>
            <span id='playgrub-icon-description'><div id='playgrub-icon-description-text'>Drag to your bookmarks bar</div></span>
        </div>
        <div id='playgrub-supported'>Use Playgrub on any of our <br /><a href='http://playgrub.posterous.com/supported-sites' target='_blank'>Suported Sites</a></div>
    </div>
    <div id='get-playdar'>
    <a href='http://www.playdar.org/download/' target='_blank'><img id='playdar-logo' src='images/playdar_logo-125px.jpg' /></a>
    </div>
</div>

    <div id='playgrub-footer-push'></div>
</div>

<div id='playgrub-footer' class='playgrub-about'>
<a href='http://playgrub.posterous.com' target='_blank'>Blog</a> | 
<a href='http://github.com/tobypadilla/playgrub' target='_blank'>GitHub</a> | 
<a href='http://twitter.com/playgrub' target='_blank'>Twitter</a> | 
By: <a href='http://twitter.com/toby' target='_blank'>Toby Padilla</a>
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-11348032-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
